version: '3.8'

# Development override file - use with: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  mongodb:
    ports:
      - "27017:27017"
    # Expose port for local MongoDB clients

  api-gateway:
    build:
      context: ./server/api-gateway
      dockerfile: Dockerfile
    volumes:
      - ./server/api-gateway:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development
    command: npm run dev

  user-manager:
    volumes:
      - ./server/user-manager-service:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  product-manager:
    volumes:
      - ./server/product-manager-service:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  order-manager:
    volumes:
      - ./server/order-manager-service:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  review-service:
    volumes:
      - ./server/review-service:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  cart-service:
    volumes:
      - ./server/cartservice:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  payment-service:
    volumes:
      - ./server/paymentservice:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development

  client:
    build:
      context: ./client
      dockerfile: Dockerfile.dev
    volumes:
      - ./client:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development
    command: npm run dev
    ports:
      - "5173:5173"
